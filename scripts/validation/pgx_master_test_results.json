{
  "test_timestamp": "2026-01-09T19:15:24.545637",
  "total_suites": 4,
  "passed": 4,
  "failed": 0,
  "production_ready": true,
  "results": {
    "E2E Tests": {
      "status": "completed",
      "exit_code": 0,
      "stdout": "\n================================================================================\nPGX E2E TEST - Real Patient Data\n================================================================================\n\u2705 API is reachable\n\n\n================================================================================\nTEST: Ayesha (MBD4+TP53) with DPYD variant\n================================================================================\n\ud83d\udcca Getting baseline drug efficacy...\n\u2705 Baseline: 9 drugs\n\n\ud83d\udee1\ufe0f  Integrating PGx screening...\n\n================================================================================\nCLINICAL ADVANTAGE:\n   - Flags high-toxicity drugs (DPYD + 5-FU = HIGH RISK)\n   - Adjusts composite scores (safety-aware ranking)\n   - Validated: 83.1% RRR (PREPARE trial, n=563)\n================================================================================\n",
      "stderr": "/Users/fahadkiani/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020\n  warnings.warn(\n",
      "success": true
    },
    "Failure Scenarios": {
      "status": "completed",
      "exit_code": 0,
      "stdout": "\n================================================================================\nPGX INTEGRATION - FAILURE TEST SUITE\n================================================================================\n\nTesting edge cases, error conditions, and failure scenarios...\n\n   \u2705 Missing drug efficacy response\n   \u2705 Empty drugs list\n   \u2705 Missing germline variants\n   \u2705 Empty germline variants list\n   \u2705 Malformed variant data\n   \u2705 Drug missing name field\n   \u2705 Invalid drug name formats\n   \u2705 Drug missing efficacy score\n   \u2705 Invalid efficacy score values\n   \u2705 Response with awaiting_ngs status\n   \u2705 Missing patient profile\n   \u2705 Missing treatment line\n   \u2705 Invalid treatment line values\n   \u2705 Missing prior therapies\n   \u2705 Invalid prior therapies format\n   \u2705 Unknown/unsupported gene\n   \u2705 Multiple variants same gene\n   \u2705 Multiple different genes\n   \u2705 Large drug list (100+ drugs)\n   \u2705 Special characters in drug names\n   \u2705 Case insensitive drug names\n   \u2705 Trials missing interventions\n   \u2705 Trials missing interventions\n   \u2705 Trials empty interventions\n   \u2705 Trials malformed interventions\n   \u2705 Concurrent requests\n   \u2705 Service timeout simulation\n\n================================================================================\nTEST SUMMARY\n================================================================================\n\u2705 Passed: 27\n\u274c Failed: 0\nTotal: 27\n\n\n================================================================================\nPRODUCTION READINESS\n================================================================================\n\u2705 All failure tests passed - System handles edge cases gracefully\n\n\ud83d\udcc4 Results saved to: /Users/fahadkiani/Desktop/development/crispr-assistant-main/oncology-coPilot/oncology-backend-minimal/scripts/validation/pgx_failure_test_results.json\n\n",
      "stderr": "/Users/fahadkiani/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020\n  warnings.warn(\nPGx screening failed: 'int' object has no attribute 'lower'\nTraceback (most recent call last):\n  File \"/Users/fahadkiani/Desktop/development/crispr-assistant-main/oncology-coPilot/oncology-backend-minimal/api/services/pgx_care_plan_integration.py\", line 63, in integrate_pgx_into_drug_efficacy\n    screening_results = await pgx_screening_service.screen_drugs(\n  File \"/Users/fahadkiani/Desktop/development/crispr-assistant-main/oncology-coPilot/oncology-backend-minimal/api/services/pgx_screening_service.py\", line 203, in screen_drugs\n    screening_result = await self.screen_drug(\n  File \"/Users/fahadkiani/Desktop/development/crispr-assistant-main/oncology-coPilot/oncology-backend-minimal/api/services/pgx_screening_service.py\", line 63, in screen_drug\n    drug_lower = drug_name.lower()\nAttributeError: 'int' object has no attribute 'lower'\nPGx screening failed for DPYD + 5-FU: 1 validation error for DosingGuidanceRequest\nprior_therapies\n  Input should be a valid list [type=list_type, input_value='not a list', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.11/v/list_type\nPGx screening failed for DPYD + 5-FU: 1 validation error for DosingGuidanceRequest\nprior_therapies\n  Input should be a valid list [type=list_type, input_value=123, input_type=int]\n    For further information visit https://errors.pydantic.dev/2.11/v/list_type\n",
      "success": true
    },
    "Integration Failures": {
      "status": "completed",
      "exit_code": 0,
      "stdout": "\n================================================================================\nPGX INTEGRATION - INTEGRATION FAILURE TESTS\n================================================================================\n\nTesting: PGx service unavailable...\n   \u2705 Handled gracefully: True\nTesting: Risk-benefit service unavailable...\n   \u2705 Handled gracefully: True\nTesting: PGx screening timeout...\n   \u2705 Timeout handled gracefully\nTesting: PGx screening returns None...\n   \u2705 Handled gracefully: True\nTesting: PGx screening returns empty dict...\n   \u2705 Handled gracefully: True\nTesting: PGx screening raises exception...\n   \u2705 Handled gracefully: True\n\n================================================================================\nSUMMARY\n================================================================================\n\u2705 Passed: 6\n\u274c Failed: 0\nTotal: 6\n\n",
      "stderr": "/Users/fahadkiani/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020\n  warnings.warn(\nFailed to get PGx screening service: Service unavailable\nTraceback (most recent call last):\n  File \"/Users/fahadkiani/Desktop/development/crispr-assistant-main/oncology-coPilot/oncology-backend-minimal/api/services/pgx_care_plan_integration.py\", line 54, in integrate_pgx_into_drug_efficacy\n    pgx_screening_service = get_pgx_screening_service()\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py\", line 1093, in __call__\n    return self._mock_call(*args, **kwargs)\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py\", line 1097, in _mock_call\n    return self._execute_mock_call(*args, **kwargs)\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py\", line 1152, in _execute_mock_call\n    raise effect\nException: Service unavailable\nFailed to get risk-benefit service: Service unavailable\nTraceback (most recent call last):\n  File \"/Users/fahadkiani/Desktop/development/crispr-assistant-main/oncology-coPilot/oncology-backend-minimal/api/services/pgx_care_plan_integration.py\", line 81, in integrate_pgx_into_drug_efficacy\n    risk_benefit_service = get_risk_benefit_composition_service()\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py\", line 1093, in __call__\n    return self._mock_call(*args, **kwargs)\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py\", line 1097, in _mock_call\n    return self._execute_mock_call(*args, **kwargs)\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py\", line 1152, in _execute_mock_call\n    raise effect\nException: Service unavailable\nPGx screening returned None - using empty dict\nPGx screening failed: Screening failed\nTraceback (most recent call last):\n  File \"/Users/fahadkiani/Desktop/development/crispr-assistant-main/oncology-coPilot/oncology-backend-minimal/api/services/pgx_care_plan_integration.py\", line 63, in integrate_pgx_into_drug_efficacy\n    screening_results = await pgx_screening_service.screen_drugs(\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py\", line 2154, in _execute_mock_call\n    raise effect\nException: Screening failed\n",
      "success": true
    },
    "Data Validation": {
      "status": "completed",
      "exit_code": 0,
      "stdout": "\n================================================================================\nPGX INTEGRATION - DATA VALIDATION TESTS\n================================================================================\n\nTesting: Variant format validation...\n   \u2705 Handled 7/7 variant formats\n\nTesting: Gene name validation...\n   \u2705 Handled 7/7 gene name formats\n\nTesting: Drug name normalization...\n   \u2705 Handled 8/8 drug name formats\n\nTesting: Numeric precision...\n   \u2705 Handled 9/9 extreme score values\n\nTesting: Unicode handling...\n   \u2705 Handled 11/11 unicode/special character names\n\n================================================================================\nSUMMARY\n================================================================================\n\u2705 Passed: 5\n\u274c Failed: 0\nTotal: 5\n\n",
      "stderr": "/Users/fahadkiani/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020\n  warnings.warn(\n",
      "success": true
    }
  }
}